# =============================================================================
# Hide Mail - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# Docker Compose automatically reads from .env in the same directory.
# =============================================================================

# -----------------------------------------------------------------------------
# Required: Domain Configuration
# -----------------------------------------------------------------------------
# Comma-separated list of email domains the service will accept
VALID_DOMAINS=hide-mail.org,private-mail.org

# -----------------------------------------------------------------------------
# Required: Email Settings (all times in seconds)
# -----------------------------------------------------------------------------
# How long emails are stored before expiration (seconds)
# Default: 1800 (30 minutes)
EMAIL_EXPIRATION_SECONDS=1800

# How much time is added when user extends mailbox (seconds)
# Default: 900 (15 minutes)
EMAIL_EXTENSION_SECONDS=900

# Grace period before expired mailboxes are fully cleaned up (days)
# During this period, emails are silently dropped instead of returning 550 errors
# This prevents domain blocklisting from rejected expired mailboxes
# Default: 7 (days)
MAILBOX_CLEANUP_GRACE_DAYS=7

# SMTP response code for unknown mailboxes (after grace period expires)
# Options:
#   550 - Permanent failure, mailbox doesn't exist (can lead to blocklisting)
#   450 - Temporary failure, try again later (sender retries)
#   250 - Catch-all mode: accept ALL emails for valid domains, silently drop
#         if mailbox not active (safest for reputation, but accepts all spam)
# Default: 550
SMTP_UNKNOWN_MAILBOX_CODE=550

# -----------------------------------------------------------------------------
# Required: API Configuration
# -----------------------------------------------------------------------------
# API URL path (relative to frontend domain)
CONFIG_API_URL=/api

# API request timeout (milliseconds)
CONFIG_API_TIMEOUT=5000

# -----------------------------------------------------------------------------
# Optional: AdSense Configuration
# -----------------------------------------------------------------------------
# Leave empty or remove to disable ads

# Your AdSense publisher ID (e.g., ca-pub-1234567890123456)
REACT_APP_ADSENSE_CLIENT=

# Ad slot IDs - get these from your AdSense dashboard
REACT_APP_ADSENSE_SLOT_TOP_BANNER=
REACT_APP_ADSENSE_SLOT_TOP_PAGE_AD=
REACT_APP_ADSENSE_SLOT_BOTTOM_PAGE_AD=
REACT_APP_ADSENSE_SLOT_SIDEBAR_RECTANGLE=
REACT_APP_ADSENSE_SLOT_MIDDLE_BANNER=
REACT_APP_ADSENSE_SLOT_BEFORE_FOOTER=
REACT_APP_ADSENSE_SLOT_FOOTER=
REACT_APP_ADSENSE_SLOT_BLOG_TOP=
REACT_APP_ADSENSE_SLOT_BLOG_BOTTOM=
REACT_APP_ADSENSE_SLOT_BLOG_POST_TOP=
REACT_APP_ADSENSE_SLOT_BLOG_POST_MIDDLE=
REACT_APP_ADSENSE_SLOT_BLOG_POST_BOTTOM=

# -----------------------------------------------------------------------------
# Backend Configuration (used by backend service)
# -----------------------------------------------------------------------------
# Log level: error, warn, info, debug
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Security: Allowed Origins (CORS & Origin Verification)
# -----------------------------------------------------------------------------
# Comma-separated list of allowed frontend origins
# Requests from other origins will be blocked
# Use wildcard for subdomains: *.example.com
# 
# Examples:
#   ALLOWED_ORIGINS=https://hide-mail.org,https://www.hide-mail.org
#   ALLOWED_ORIGINS=https://hide-mail.org,*.hide-mail.org
#
# In development, localhost:3000 and localhost:3001 are always allowed
ALLOWED_ORIGINS=https://hide-mail.org,https://www.hide-mail.org

# Redis connection URL
REDIS_URL=redis://redis:6379

# Backend ports (internal)
PORT=3001
SMTP_PORT=2525

# -----------------------------------------------------------------------------
# Forward & Forget Feature - Email Forwarding Configuration
# -----------------------------------------------------------------------------
# Privacy-focused email forwarding with OTP validation
#
# Architecture:
#   Development: Backend -> Postfix -> Mailpit (http://localhost:8025)
#   Production:  Backend -> Postfix (OpenDKIM) -> Internet
#
# Email authentication handled by:
#   - DKIM: Postfix (OpenDKIM) signs outgoing emails
#   - SRS:  Backend rewrites sender for SPF alignment
#   - SPF:  Configure DNS for your domain

# Backend SMTP Configuration (connects to Postfix)
# These defaults work with the included Postfix service
SMTP_HOST=postfix
SMTP_OUTGOING_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_SECURE=false
SMTP_FROM_EMAIL=noreply@hide-mail.org
SMTP_FROM_NAME=Hide Mail

# -----------------------------------------------------------------------------
# Postfix Configuration (Outgoing SMTP Relay)
# -----------------------------------------------------------------------------
# Postfix handles outgoing email delivery:
# - In development: Postfix relays to Mailpit for email inspection
# - In production: Postfix sends directly to destination mail servers
#
# IMPORTANT: Set POSTFIX_HOSTNAME to match your domain's PTR record for best deliverability

# Hostname for HELO/EHLO - should match your server's PTR record
POSTFIX_HOSTNAME=mail.hide-mail.org

# -----------------------------------------------------------------------------
# DKIM Signing (optional, improves deliverability)
# -----------------------------------------------------------------------------
# boky/postfix uses OpenDKIM for DKIM signing
#
# To generate DKIM keys:
#   mkdir -p ./dkim-keys/hide-mail.org
#   opendkim-genkey -s mail -d hide-mail.org -D ./dkim-keys/hide-mail.org
#
# Then add the public key to DNS:
#   mail._domainkey.hide-mail.org TXT "v=DKIM1; k=rsa; p=<content-of-mail.txt>"
#
# The keys directory structure should be:
#   ./dkim-keys/
#     hide-mail.org/
#       mail.private
#       mail.txt

# DKIM selector (default: mail)
DKIM_SELECTOR=mail
# Path to DKIM keys directory (mounted to /etc/opendkim/keys in container)
DKIM_KEYS_PATH=./dkim-keys

# -----------------------------------------------------------------------------
# SRS (Sender Rewriting Scheme) - Required for SPF alignment when forwarding
# -----------------------------------------------------------------------------
# SRS is handled by the backend (srsService.js) to rewrite the envelope sender
# when forwarding emails. This ensures forwarded emails pass SPF checks.
#
# SRS_DOMAIN: Domain used for rewritten sender addresses (e.g., hide-mail.org)
#             This domain MUST have SPF records allowing your server to send
# SRS_SECRET: Secret key for SRS hash generation
#             Generate with: openssl rand -base64 32
#
# Example: When forwarding from alice@example.com via temp@hide-mail.org
#   Original sender: alice@example.com
#   SRS rewritten:   SRS0=HHH=TT=example.com=alice@hide-mail.org
#
# DNS SPF record for SRS_DOMAIN should include your mail server IP:
#   hide-mail.org TXT "v=spf1 ip4:YOUR_SERVER_IP -all"

SRS_DOMAIN=hide-mail.org
SRS_SECRET=

# Rate Limiting
# Maximum forwards per hour per temporary mailbox
FORWARDING_RATE_LIMIT=10

# OTP Settings
# Expiration time in minutes
OTP_EXPIRATION_MINUTES=15
# Length of OTP code (digits only)
OTP_LENGTH=6